FROM python:3.6.5-alpine3.7

# Meta-data
LABEL maintainer="Aly Sivji <alysivji@gmail.com>" \
      description="Docker Data Science Workflow #3: Data Driven Application\
      This specific use case has the container set up like an executible.\
      Code plus dependencies required to run the program are installed in the\
      container. Data are set up via a mounted folder. Executing\
      docker run with a parameter starts up a dashboard"

# Set the working directory to /app
WORKDIR /app

# ensures that the python output is sent to the terminal without buffering
ENV PYTHONUNBUFFERED=TRUE

# Copy the current directory contents into the container at /app
COPY . /app

# create a virtual environment and activate it
RUN python3 -m venv generate_data

# activate virtual environment
CMD source generate_data/bin/activate

# pip install
RUN pip --no-cache-dir install pandas==1.1.5 && \
    pip --no-cache-dir install numpy==1.19.5

# Create mountpoint
VOLUME /app/data

# ENTRYPOINT allows us to specify the default executible
ENTRYPOINT ["python"]

# CMD sets default arguments to executable which may be overwritten when using docker run
CMD ["generate_data.py"]